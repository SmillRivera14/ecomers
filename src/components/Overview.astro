---
import Layout from '../layouts/Layout.astro';

// Datos simulados para las mÃ©tricas y el histograma
const metrics = {
  totalCustomers: 1248,
  activeDeals: 324,
  revenue: 45231.89,
  customerSatisfaction: 92,
  growth: {
    totalCustomers: 12,
    activeDeals: 4,
    revenue: 20.1,
    customerSatisfaction: 2,
  },
};

// Datos ajustados para el histograma (estimados visualmente desde la imagen)
const salesData = [
  { month: 'Jan', sales: 10000 },
  { month: 'Feb', sales: 12000 },
  { month: 'Mar', sales: 15000 },
  { month: 'Apr', sales: 18000 },
  { month: 'May', sales: 20000 },
  { month: 'Jun', sales: 25000 },
  { month: 'Jul', sales: 30000 },
  { month: 'Aug', sales: 35000 },
  { month: 'Sep', sales: 40000 },
  { month: 'Oct', sales: 50000 },
  { month: 'Nov', sales: 60000 },
  { month: 'Dec', sales: 75000 }, // Ajustado para que coincida con el pico visual
];

const recentSales = [
  { name: 'Olivia Martin', email: 'olivia.martin@email.com', amount: 1999.0 },
  { name: 'Jackson Lee', email: 'jackson.lee@email.com', amount: 39.0 },
  {
    name: 'Isabella Nguyen',
    email: 'isabella.nguyen@email.com',
    amount: 299.0,
  },
  { name: 'William Kim', email: 'william.kim@email.com', amount: 99.0 },
  { name: 'Sofia Davis', email: 'sofia.davis@email.com', amount: 39.0 },
];
---

<Layout title="CRM Dashboard">
  <!-- Encabezado -->
  <header class="dashboard-header">
    <h1>CRM DASHBOARD</h1>
    <nav>
      <button class="tab active">Overview</button>
      <button class="tab">Customers</button>
      <button class="tab">Analytics</button>
    </nav>
    <button class="export-btn">Export</button>
  </header>

  <!-- SecciÃ³n de mÃ©tricas -->
  <div class="metrics">
    <div class="metric-card">
      <div class="metric-header">
        <h3>Total Customers</h3>
        <span class="icon">ðŸ‘¤</span>
        <!-- Placeholder para el Ã­cono -->
      </div>
      <p class="value">{metrics.totalCustomers.toLocaleString()}</p>
      <p class="growth">+{metrics.growth.totalCustomers}% from last month</p>
    </div>
    <div class="metric-card">
      <div class="metric-header">
        <h3>Active Deals</h3>
        <span class="icon">ðŸ“Š</span>
        <!-- Placeholder para el Ã­cono -->
      </div>
      <p class="value">{metrics.activeDeals}</p>
      <p class="growth">+{metrics.growth.activeDeals}% from last month</p>
    </div>
    <div class="metric-card">
      <div class="metric-header">
        <h3>Revenue</h3>
        <span class="icon">ðŸ’µ</span>
        <!-- Placeholder para el Ã­cono -->
      </div>
      <p class="value">${metrics.revenue.toLocaleString()}</p>
      <p class="growth">+{metrics.growth.revenue}% from last month</p>
    </div>
    <div class="metric-card">
      <div class="metric-header">
        <h3>Customer Satisfaction</h3>
        <span class="icon">ðŸ“ˆ</span>
        <!-- Placeholder para el Ã­cono -->
      </div>
      <p class="value">{metrics.customerSatisfaction}%</p>
      <p class="growth">
        +{metrics.growth.customerSatisfaction}% from last month
      </p>
    </div>
  </div>

  <!-- SecciÃ³n de Sales Overview y Recent Sales -->
  <div class="content">
    <!-- Sales Overview (Histograma) -->
    <div class="sales-overview">
      <h2>Sales Overview</h2>
      <div class="histogram-container">
        <div class="y-axis">
          <span>$80K</span>
          <span>$60K</span>
          <span>$40K</span>
          <span>$20K</span>
          <span>$0K</span>
        </div>
        <div class="histogram">
          {
            salesData.map((data) => (
              <div
                class="bar"
                style={`height: ${(data.sales / 80000) * 200}px;`}
              >
                <span class="bar-label">{data.month}</span>
              </div>
            ))
          }
        </div>
      </div>
    </div>

    <!-- Recent Sales -->
    <div class="recent-sales">
      <h2>Recent Sales</h2>
      <p>You made 265 sales this month.</p>
      <ul>
        {
          recentSales.map((sale) => (
            <li>
              <div class="sale-info">
                <div class="avatar" />
                <div>
                  <p class="name">{sale.name}</p>
                  <p class="email">{sale.email}</p>
                </div>
              </div>
              <p class="amount">+${sale.amount.toLocaleString()}</p>
            </li>
          ))
        }
      </ul>
    </div>
  </div>
</Layout>

<style>
  .dashboard-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
  }

  .dashboard-header h1 {
    font-size: 24px;
    font-weight: bold;
  }

  .dashboard-header nav {
    display: flex;
    gap: 10px;
  }

  .tab {
    background: #f5f5f5;
    border: none;
    padding: 8px 16px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
  }

  .tab.active {
    background: #fff;
    border: 1px solid #ddd;
  }

  .export-btn {
    background: #333;
    color: #fff;
    border: none;
    padding: 8px 16px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
  }

  .metrics {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 20px;
    margin-bottom: 20px;
  }

  .metric-card {
    background: #fff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  .metric-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .metric-card h3 {
    margin: 0;
    font-size: 14px;
    color: #666;
  }

  .metric-card .icon {
    font-size: 16px;
    color: #999;
  }

  .metric-card .value {
    font-size: 24px;
    font-weight: bold;
    margin: 10px 0;
  }

  .metric-card .growth {
    color: #28a745;
    font-size: 12px;
  }

  .content {
    display: flex;
    gap: 20px;
  }

  .sales-overview {
    background: #fff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    flex: 2;
    position: relative;
  }

  .sales-overview h2 {
    margin: 0 0 20px 0;
    font-size: 18px;
  }

  .histogram-container {
    display: flex;
    position: relative;
  }

  .y-axis {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: 200px;
    font-size: 12px;
    color: #666;
    margin-right: 10px;
    padding-top: 5px;
    padding-bottom: 5px;
  }

  .histogram {
    display: flex;
    gap: 5px;
    height: 200px;
    align-items: flex-end;
    flex: 1;
  }

  .bar {
    background: #333;
    width: 100%;
    flex: 1;
    border-radius: 4px 4px 0 0;
    position: relative;
  }

  .bar-label {
    position: absolute;
    bottom: -20px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 12px;
    color: #666;
  }

  .recent-sales {
    background: #fff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    flex: 1;
  }

  .recent-sales h2 {
    margin: 0 0 10px 0;
    font-size: 18px;
  }

  .recent-sales p {
    margin: 0 0 20px 0;
    color: #666;
    font-size: 14px;
  }

  .recent-sales ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .recent-sales li {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 0;
    border-bottom: 1px solid #eee;
  }

  .sale-info {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .avatar {
    width: 40px;
    height: 40px;
    background: #ddd;
    border-radius: 50%;
  }

  .name {
    font-weight: bold;
    margin: 0;
    font-size: 14px;
  }

  .email {
    color: #666;
    font-size: 12px;
    margin: 0;
  }

  .amount {
    font-weight: bold;
    color: #28a745;
    font-size: 14px;
  }
</style>
